#!@PERL@ -w

# use strict;

unless (@ARGV == 1) {
    print <<EOD;
Usage:
  make-dylan-app appname
EOD
    exit 1;
}

$appname = $ARGV[0];

mkdir $appname, 0777 or die "Can't create directory $appname: $!";
chdir $appname or die "Can't chdir to directory $appname: $!";

&write_file("$appname.lid", <<"EOD");
library: $appname
executable: $appname
entry-point: $appname:%main

$appname-exports.dylan
$appname.dylan
EOD

&write_file("$appname-exports.dylan", <<"EOD");
module: dylan-user

define library $appname
  use dylan;
  use format-out;
  //use streams;
  //use standard-io;
  //use format;
end library;

define module $appname
  use dylan;
  use extensions;
  use format-out;
  //use streams;
  //use standard-io;
  //use format;
end module;
EOD

&write_file("$appname.dylan", <<"EOD");
module: $appname
synopsis: 
author: 
copyright: 

define method main(appname, #rest arguments)
  format-out("Hello, world from $appname!\\n");
  exit(exit-code: 0);
end method main;
EOD

sub write_file {
    local ($filename, $contents) = @_;
    open(OUTPUT, ">$filename") or die "Can't create $filename: $!";
    print OUTPUT $contents;
    close OUTPUT;
}
